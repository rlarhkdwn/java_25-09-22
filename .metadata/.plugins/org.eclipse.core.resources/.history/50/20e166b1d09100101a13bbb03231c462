package examStudent;

import java.util.ArrayList;
import java.util.List;
import java.util.Scanner;

public class StudentController implements studentProgram {
	
	private List<Student> studentList = new ArrayList<>();
	

	public StudentController() {}

	public String menuPrint(Scanner scan, StudentMain sm) {
		while (true) {
			System.out.println("=====menu=====");
			System.out.println("1. 학생 등록");
			System.out.println("2. 학생 리스트");
			System.out.println("3. 학생 검색");
			System.out.println("4. 학생 정보 수정");
			System.out.println("5. 학생 삭제");
			System.out.println("6. 수강 신청");
			System.out.println("7. 수강 철회");
			System.out.println("8. 과목별 신청자 리스트");
			System.out.println("9. 종료");
			String input = scan.nextLine();
			if (sm.allDisit(input)) {
				return input;
			}
			System.out.println("잘못된 메뉴입니다.");
		}
	}
	
	@Override
	public void insertStudent(Scanner scan) {
		System.out.print("이름: ");
		String name = scan.nextLine();
		System.out.print("나이: ");
		String age = scan.nextLine();
		System.out.print("전화번호: ");
		String phone = scan.nextLine();
		System.out.print("주소: ");
		String address = scan.nextLine();
		Student s = new Student(name, age, phone, address);
		
		studentList.add(s);
		System.out.println("학생 등록 완료!");
	}

	@Override
	public void printStudent() {
		if (!studentList.isEmpty()) {
			for (int i = 0; i < studentList.size(); i++) {
				System.out.print(i + 1 + ". ");
				studentList.get(i).printStudent();
				studentList.get(i).printSubjectList();
				System.out.println();
			}
		}
		else {
			System.out.println("등록된 학생이 없습니다.");
		}
	}

	@Override
	public Student searchStudent(Scanner scan, StudentMain sm) {
		String strNum;
		while (true) {
			System.out.print("학번: ");
			strNum = scan.nextLine();
			if (sm.allDisit(strNum)) {
				break;
			}
			System.out.println("숫자를 입력해주세요");
		}
		int intNum = Integer.parseInt(strNum);
		for (int i = 0; i < studentList.size(); i++) {
			if (studentList.get(i).getStudentCode() == intNum) {
				studentList.get(i).printStudent();
				studentList.get(i).printSubjectList();
				return studentList.get(i);
			}
		}
		System.out.println("해당 학생이 없습니다.");
		return null; // 해당 학생이 없는 경우
	}

	@Override
	public void insertSubject(Scanner scan, StudentMain sm) {
		Student std = searchStudent(scan, sm);
		if (std == null) {
			return;
		}
		
		System.out.println("=====강의 리스트=====");
		for (int i = 0; i < sm.subjectList.size(); i++) {
			System.out.print(i + 1 + ". ");
			sm.subjectList.get(i).print();
		}
		
		String strNum;
		while (true) {
			System.out.print("학과 코드: ");
			strNum = scan.nextLine();
			if (sm.allDisit(strNum)) {
				break;
			}
			System.out.println("숫자를 입력해주세요");
		}
		
		int intNum = Integer.parseInt(strNum);
		for (Subject sub : sm.subjectList) {
			if (sub.getSubjectCode() == intNum) {
				std.insertSubject(sub);
				return;
			}
		}
		System.out.println("해당 과목이 없습니다.");
	}

	@Override
	public void deleteSubject(Scanner scan, StudentMain sm) {
		Student std = searchStudent(scan, sm);
		if (std == null) {
			return;
		}
		
		if (std.getSubjectList().isEmpty()) {
			return;
		}
		
		String strNum;
		while (true) {
			System.out.print("학과 코드: ");
			strNum = scan.nextLine();
			if (sm.allDisit(strNum)) {
				break;
			}
			System.out.println("숫자를 입력해주세요");
		}
		
		std.deleteSubject(Integer.parseInt(strNum));
	}
}